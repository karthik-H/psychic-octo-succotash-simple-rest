{
  "add_new_user": {
    "implementation": [
      {
        "function_name": "create_user",
        "file_path": "app/routers/users.py",
        "How_is_it_connected_to_implementation": "API endpoint handler for adding a new user. Receives user data, checks for duplicate email, and calls the service layer to create the user.",
        "pseudo_code": "If a user with the given email exists, raise an error. Otherwise, call the service to create the user."
      },
      {
        "function_name": "get_user_by_email",
        "file_path": "app/services.py",
        "How_is_it_connected_to_implementation": "Checks if a user with the given email already exists in the database. Used to enforce the unique email constraint before adding a new user.",
        "pseudo_code": "Query the database for a user with the given email. Return the user if found, else return None."
      },
      {
        "function_name": "create_user",
        "file_path": "app/services.py",
        "How_is_it_connected_to_implementation": "Creates and persists a new user in the database with the provided email and name.",
        "pseudo_code": "Create a new User model instance with the provided email and name. Add to the database, commit, refresh, and return the user."
      }
    ],
    "missing_implementations": [
      "Username must not be duplicate",
      "Age must be in the range 0-150"
    ]
  },
  "update_email_address": {
    "implementation": [
      {
        "function_name": "update_user",
        "file_path": "app/routers/users.py",
        "How_is_it_connected_to_implementation": "This is the FastAPI route handler for updating a user's information, including their email address. It receives the HTTP PUT request, extracts the user_id and new user data, and delegates the update operation to the service layer.",
        "pseudo_code": "Receive PUT request with user_id and new user data; Call services.user_service.update_user with db, user_id, and user; If user not found, raise 404; Return updated user."
      },
      {
        "function_name": "UserService.update_user",
        "file_path": "app/services.py",
        "How_is_it_connected_to_implementation": "This service function performs the actual update of the user's email address in the database. It fetches the user by ID, updates the email and name fields, commits the transaction, and returns the updated user.",
        "pseudo_code": "Fetch user by user_id; If user exists: set db_user.email = user.email; set db_user.name = user.name; commit changes; refresh user; Return updated user."
      }
    ],
    "missing_implementations": []
  },
  "deactivate_user_account": {
    "implementation": [
      {
        "function_name": "delete_user",
        "file_path": "app/routers/users.py",
        "How_is_it_connected_to_implementation": "This is the API endpoint for deleting a user account. It is the only endpoint that could be interpreted as 'deactivating' a user account, but it actually deletes the user from the database.",
        "pseudo_code": "When a DELETE request is made to /users/{user_id}, call services.user_service.delete_user(db, user_id). If the user does not exist, return 404. Otherwise, return the deleted user."
      },
      {
        "function_name": "UserService.delete_user",
        "file_path": "app/services.py",
        "How_is_it_connected_to_implementation": "This service function is called by the API endpoint to perform the actual deletion of the user from the database.",
        "pseudo_code": "Fetch the user by user_id. If the user exists, delete the user from the database and commit the transaction. Return the deleted user object."
      }
    ],
    "missing_implementations": [
      "No function implements a true 'deactivate' (soft delete or status change) for user accounts. The current implementation deletes the user entirely from the database instead of deactivating the account."
    ]
  },
  "calculate_average_age": {
    "implementation": [],
    "missing_implementations": [
      "Calculate average age of active users.",
      "Only active users are considered"
    ]
  },
  "categorize_user_into_age": {
    "implementation": [],
    "missing_implementations": [
      "Youth: 0-17",
      "Adult: 18-64",
      "Senior: 65+"
    ]
  }
}